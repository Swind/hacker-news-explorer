---
story_id: 46849567
hn_url: https://news.ycombinator.com/item?id=46849567
title: "Defeating a 40-year-old copy protection dongle"
verdict: interesting
created_at: 2026-02-02T04:17:22
updated_at: 2026-02-03T04:46:57
---



# 2026-02-02: Defeating a 40-year-old copy protection dongle

**來源：** Hacker News
**故事 ID：** 46849567
**Hacker News 連結：** https://news.ycombinator.com/item?id=46849567
**網址：** https://dmitrybrant.com/2026/02/01/defeating-a-40-year-old-copy-protection-dongle
**分數：** 305 | **評論數：** 85

## 摘要

這是一篇關於逆向工程軟體考古的精彩技術文章。作者協助一家會計公司從使用 40 年歷史的遺留 RPG 語言軟體遷移，發現該軟體需要連接到平行埠的硬體加密鎖才能運行。作者透過反彙編分析，發現加密鎖只是返回一個常數值（7606h），最終用 4 位元組的 patch 就成功繞過了這個"已取得專利"的複製保護機制。

## 為什麼有趣

這個故事具備多維度的吸引力：

**技術考古價值**：文章涉及 40 年前的技術棧——RPG 程式語言（比 COBOL 更古老）、IBM System/3 到 AS/400 的中型主機、DOS 時代的軟體保護機制。這是珍貴的運算歷史記錄。

**精巧的逆向工程**：作者展示了完整的破解過程：
- 使用 Reko 反彙編工具分析 16 位元實模式執行檔
- 發現保護常式位於獨立的 0x80 區段（可能是早期混淆手法）
- 透過暴力破解 256 種可能性找到正確的 magic number
- 最終的 patch 僅需 4 位元組：`BB 06 76 MOV BX, 7606h` + `CB RETF`

**產業洞察**：評論區展現了軟體授權模式的演變辯論。硬體加密鎖在今天仍被某些行業（如土木工程、核能、軍事）偏好，因為它們需要離線、無網路的環境運作。

**商業模式反思**：從永續授權到 SaaS 訂閱制的轉變，以及軟體保護的必要性與使用者體驗的平衡。

## 主要討論點

### 軟體保護的必要性
**業內人士觀點**：土木工程軟體開發者表示，至今仍有客戶偏好實體加密鎖而非雲端驗證，原因包括：
- 需要在隔離電腦上運作（敏感基礎設計）
- 確保擁有實體控制權
- 不依賴第三方授權伺服器

### 企業盜版問題
多個評論指出，1990 年代企業盜版非常普遍。即使有加密鎖保護，破解版本仍在 Shopee、Lazada 等平台流通。企業客戶也會為了節省成本而進行"隨意盜版"。

### 永續授權 vs SaaS
**雙方論點**：
- **永續授權擁護者**：SaaS 對終端用戶如同瘟疫，"如果沒壞，就別修它"，一次性購買更合理
- **開發者立場**：在法規變化慢的領域，使用者升級意願低，SaaS 是確保持續維護和 bug 修復的唯一途徑

### 硬體加密鎖的可靠性問題
- 實體裝置會損壞，且更換零件不易取得
- 開發商應提供 30 年以上保固
- 需要有長期支援和更換計畫

## 評價

**值得閱讀 (⭐⭐⭐⭐)**

這是一個完美的技術考古案例，結合了：
1. **技術深度**：展示真正的逆向工程技能
2. **歷史價值**：記錄了即將消失的運算遺產
3. **實用意義**：幫助企業從遺留系統遷移
4. **產業討論**：引發對軟體保護和商業模式的深度思考

特別值得稱讚的是作者計畫在清理敏感資料後，將這個 RPG II 編譯器作為運算歷史文物公開發布，造福社群。

技術價值：⭐⭐⭐⭐
歷史意義：⭐⭐⭐⭐⭐
社群參與：⭐⭐⭐（85 則評論，高品質討論）

---

## 更新 [2026-02-02 下午]

**新評論：** +110 則評論（共 195 則）
**分數變化：** 305 → 458 (+153)

### 主要更新內容

經過更深入的文章分析和評論區追蹤，這篇報告需要進行重大補充。

#### 1. 更詳細的技術分析

**保護機制的完整流程**：

原始報告已提到基本的破解過程，但補充以下技術細節：

- **Segment 0800 的發現**：Reko 反彙編器將執行檔分為兩個 segments（0800 和 0809），保護常式位於獨立的 0800 segment，僅 0x90 bytes（144 位元組）。這可能是早期的混淆手法。

- **Parallel Port 通訊協議**：
  - 從 BIOS data area 讀取 parallel port 位址
  - 如果電腦有多個 parallel port，dongle 必須連接到 LPT1
  - 透過 loop 寫入值到 data register，讀取 status register
  - 累積回應到 BH 和 BL 暫存器

- **暴力破解過程**：
  - 作者撰寫 script 自動在 DosBox 中測試 256 種可能值
  - 正確答案非常快就被找到（BL = 06h）
  - 完整 magic number: `7606h`

#### 2. 破解技術的歷史回顧

評論區分享了許多 1990 年代的破解經驗：

**HEX 編輯破解時代**：
- 修改試用版限制（如 CD 燒錄軟體的 150MB 限制）
- 直接搜尋十六進位數值並修改為更大數值

**Registry 修改技巧**：
- 將試用時間從 30 分鐘改為 `4294967295` 分鐘（UINT32_MAX）
- 一位 10 歲小孩為奶奶破解遊戲試用版的故事

**單一位元破解案例**：
- 將 `JGT`（Jump if greater than）改成 `JLT`（Jump if less than）
- 反轉日期檢查邏輯，讓軟體在「某日期之前」而非「之後」停止運作
- 開發者在合約終止後加入時間炸彈，技術人員用一個 bit flip 解決

#### 3. Dongle 的趣聞軼事

**搞混的 dongle**：
- 老闆測試客戶退回的「壞掉」dongle，誤把員工的 PowerPCB dongle 寄回給客戶
- 導致設計軟體無法使用，引發一連串有趣後果

**Dongle bus**：
- 實驗室工程師製作可串接多個 dongle 的「dongle bus」
- 經常插滿半打以上的 dongle（CAD 和 PCB layout 軟體都需要）

**正版反而用破解版**：
- 某公司有合法授權，但員工都安裝破解版
- 原因：用 dongle 太難用

#### 4. Copy Protection 設計缺陷的深度分析

**為什麼早期的 copy protection 這麼容易破解？**

1. **開發者的權衡困境**：
   - 過度混淆會讓除錯變得困難
   - 影響開發效率和 bug 修復
   - 「hostile code」可能扼殺整個專案

2. **訓練不足問題**：
   - 開發者需要了解所有破解技巧才能防範
   - 但破解者只需找到一個漏洞就成功
   - 比例：300 個破解者 vs 1 個開發者（今天可能是 30,000 vs 1）

3. **缺乏動機**：
   - Copy protection 是要「證明沒有被破解」（證明否定）
   - 做得好沒人會注意到，做得不好會被嘲笑
   - 是 checkbox 功能，沒有成就感

4. **實作問題**：
   - 許多程式在記憶體中保留正確的金鑰
   - 沒有做 zeroize（清零）就直接比對
   - 輸入假金鑰後 dump 記憶體，就能在附近找到真實金鑰

#### 5. 現代實例

**Mellanox 交換器**：
- 韌體包中包含可產生金鑰的 keygen
- 秘密金鑰直接用 `strings` 指令就能看到
- 工具本身既能產生金鑰也能驗證金鑰

**字串比對法**：
- 輸入假金鑰後對記憶體 dump
- 在假金鑰附近尋找真實金鑰
- 原因：程式使用 hash 計算金鑰後，直接比對而不清零暫存區

#### 6. RPG 語言與遺產系統

**RPG（Report Program Generator）**：
- 比 COBOL 更古老的程式語言
- 用於 IBM System/3、System/32、AS/400 等中型主機
- 後來移植到 MS-DOS，讓相同工具可在 PC 上執行

**遺產系統的挑戰**：
- 會計事務所直到 2026 年仍在用 Windows 98 + DOS 軟體
- 需要硬體 dongle 才能執行
- 遷移需要專門知識和工具

**作者計畫**：
- 清理敏感資料後公開 RPG II compiler
- 這個工具可能在網路上找不到其他副本
- 作為計算歷史文物保存

#### 7. 更新評價

**技術價值極高** → 從「有趣」提升為「技術價值極高」

理由：
- 系統性的逆向工程示範
- 珍貴的軟體考古記錄
- 評論區提供了 1990 年代破解技術的完整回顧
- 對企業現代化專案具有實用價值

**評價更新**：
- 技術深度：⭐⭐⭐⭐⭐（完整示範系統化破解流程）
- 歷史意義：⭐⭐⭐⭐⭐（保存 40 年前的開發工具）
- 社群參與：⭐⭐⭐⭐⭐（195 則高品質評論）
- 實用價值：⭐⭐⭐⭐（企業遺留系統遷移的參考）

這是一篇**經典學習案例**，結合了歷史、技術和實作，是學習逆向工程和軟體保護機制的絕佳教材。
---
story_id: 46849567
hn_url: "https://news.ycombinator.com/item?id=46849567"
title: "Defeating a 40-year-old copy protection dongle"
verdict: interesting
created_at: 2026-02-03T00:00:00
---

# 2026-02-03: 擊敗 40 年前的複製保護狗

**來源：** Hacker News
**故事 ID：** 46849567
**Hacker News 連結：** https://news.ycombinator.com/item?id=46849567
**網址：** https://dmitrybrant.com/2026/02/01/defeating-a-40-year-old-copy-protection-dongle
**分數：** 823 | **評論數：** 271

## 摘要

本文描述了一位工程師協助會計事務所從極其古老的軟體系統遷移資料的過程。該系統使用 IBM RPG 程式語言編寫，需要連接到平行埠的硬體複製保護狗才能運作。作者透過逆向工程分析編譯器的 16 位元組合碼，發現保護機制的回傳值是常數，最終使用暴力破解找出正確的魔數值，並用僅 4 位元組的 patch 成功繞過了這個已有 40 年歷史的硬體保護。

## 為什麼有趣

這是一個**極具技術與歷史價值**的故事，展現了軟體考古學的精髓：

1. **技術考古的極致體現**：作者在 2026 年遇到了仍在使用 Windows 98 運行 DOS 應用程式的會計事務所，該軟體使用比 COBOL 更古老的 RPG 語言編寫。這種「活化石」般的系統在現代世界中極為罕見。

2. **優雅的逆向工程**：作者使用 Reko 反組譯工具分析 16 位元實模式執行檔，發現保護常式僅有 0x90 位元組大小。透過精細的組合碼分析，推斷出保護機制的輸出必然是常數值，從而大幅簡化破解工作。

3. **歷史與技術的交織**：保護狗製造商 Software Security Inc. 曾在 1990 年代初的 SIGGRAPH 會議展出，並擁有多項軟體保護專利。然而，這個「專利級」的保護機制實際上只是傳回一個固定值 (7606h)，可用 4 位元組的 patch 繞過，具有強烈的歷史諷刺意味。

4. **暴力的詩意**：作者發現 BH 暫存器值固定為 76h，只需暴力破解 256 種可能的 BL 值。使用 DosBox 自動化測試，在短短時間內就找到了正確值 06h。這種「現代技術解決古代問題」的對比令人印象深刻。

5. **蝴蝶效應般的設計缺陷**：最諷刺的是，patch 過的編譯器會將同樣的 patch 複製到它編譯的所有執行檔中。原本的保護機制變成了自我傳播的「去保護」機制。

## 主要討論點

**硬體保護狗的痛苦回憶**

- 許多評論者分享了過去與平行埠保護狗相關的經驗，包括老闆誤將員工的保護狗寄給客戶導致整個團隊無法工作
- 有工程師建造了「dongle bus」可串接多達六個保護狗，CAD 機器經常插滿
- 某公司雖然擁有合法授權，但所有員工都使用破解版，因為保護狗會導致軟體「根本無法使用」

**童年的破解經驗**

- 有位用戶分享 10 歲時將試用版遊戲的時間限制從 30 分鐘修改為 4294967295 分鐘
- 另一位通過修改登錄檔幫祖母破解遊戲，每次收取 5 美元
- 還有人透過修改十六進位值破解 CD 燒錄軟體的 150MB 限制

**ISP 時代的聰明破解**

- 有人發現撥號上線服務的免費技術支援視窗會暫停計費，於是寫程式將其強制置入背景
- NetZero 等廣告支援的撥號服務可以透過複製撥號連結設定來跳過廣告瀏覽器
- 有用戶利用自動重連功能獲得「超過 24 小時」的連線時間，被 ISP 控告使用 2000-3000 小時

**軟體保護的時間炸彈**

- 有開發者在軟體中加入日期檢查，合約結束後軟體停止運作
- 另一位開發者透過檢查使用者名稱來限制軟體只能在特定團隊使用
- 有自由接案者因客戶拒付帳單，在網站中加入「時間炸彈」，30 天未付款網站自動下線
- 有人成功將 JGT (Jump if Greater Than) 改為 JLT (Jump if Less Than) 靠一個位元翻轉修復了時間炸彈

**對古老系統的反思**

- 許多人對會計事務所仍在使用 Windows 98 系統感到震驚
- 討論了依賴單一硬體保護狗的企業風險
- 有人提到這些古老系統的資料遷移困難

## 評價

**非常值得一讀** - 這是一個完美的軟體考古故事，結合了：
- **歷史價值**：見證了 1980-1990 年代的軟體保護技術與企業軟體生態
- **技術深度**：展示瞭解決複雜問題的系統性方法——從磁碟映像分析、反組譯、邏輯推理到自動化暴力破解
- **實用性**：對於需要處理遺留系統遷移的 IT 專業人士很有啟發
- **趣味性**：評論區的集體回憶錄讓故事更加豐富，從硬體保護狗到 ISP 時代的各種破解技巧

作者的開放精神也值得稱讚，計畫在清理 PII 後將這個古老的 RPG II 編譯器作為計算機歷史文物發佈，讓這段歷史得以保存。

這篇文章提醒我們，今天的「絕佳保護機制」可能成為明天考古學家的笑話，而軟體的可維護性與可遷移性比任何保護機制都更重要。